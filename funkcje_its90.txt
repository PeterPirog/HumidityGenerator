Attribute VB_Name = "Module1"

Function Wr_t(t As Variant)
' funkcja odniesienia wg MST-90
Dim sum As Variant
Dim i As Integer
Dim a(0 To 12) As Variant
a(0) = -2.13534729
a(1) = 3.1832472
a(2) = -1.80143597
a(3) = 0.71727204
a(4) = 0.50344027
a(5) = -0.61899395
a(6) = -0.05332322
a(7) = 0.28021362
a(8) = 0.10715224
a(9) = -0.29302865
a(10) = 0.04459872
a(11) = 0.11868632
a(12) = -0.05248134

Dim c(0 To 9) As Variant
c(0) = 2.78157254
c(1) = 1.64650916
c(2) = -0.1371439
c(3) = -0.00649767
c(4) = -0.00234444
c(5) = 0.00511868
c(6) = 0.00187982
c(7) = -0.00204472
c(8) = -0.00046122
c(9) = 0.00045724

sum = 0

If t < 0 Then
For i = 1 To 12
sum = sum + a(i) * ((Log((t + 273.15) / 273.16) + 1.5) / 1.5) ^ i
Next i
Wr_t = Exp(a(0) + sum)
End If

If t > 0 Then
For i = 1 To 9
sum = sum + c(i) * ((t / 481) - 1) ^ i
Wr_t = c(0) + sum
Next i

End If

End Function

#######################################################################################


Function t(R As Variant)
'temperatura z rezystancji - nie skoï¿½czona!
Dim a, bo, c, Rtpw As Double
Dim i, sum As Variant
Dim B(0 To 15) As Variant

a = 1
bo = 1
c = 1
Rtpw = 25

B(0) = 0.183324722
B(1) = 0.240975303
B(2) = 0.209108771
B(3) = 0.190439972
B(4) = 0.142648498
B(5) = 0.077993465
B(6) = 0.012475611
B(7) = -0.032267127
B(8) = -0.075291522
B(9) = -0.05647067
B(10) = 0.076201285
B(11) = 0.123893204
B(12) = -0.029201193
B(13) = -0.091173542
B(14) = 0.001317696
B(15) = 0.026025526

Dim D(0 To 9) As Variant
D(0) = 439.932854
D(1) = 472.41802
D(2) = 37.684494
D(3) = 7.472018
D(4) = 2.920828
D(5) = 0.005184
D(6) = -0.963864
D(7) = -0.188732
D(8) = 0.191203
D(9) = 0.049025

sum = 0

If R < Rtpw Then
For i = 1 To 15
'sum = sum + B(i) * ((Log((t + 273.15) / 273.16) + 1.5) / 1.5) ^ i
Next i





End Function
